<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>트레이너 예약 스케줄</title>
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
    }

    .container {
      display: flex;
      padding: 20px;
      gap: 20px;
    }

    .calendar {
      width: 300px;
      background: #fff;
      padding: 10px;
      border: 1px solid #ccc;
    }

    .calendar-header {
      text-align: center;
      margin-bottom: 10px;
    }

    .calendar-table {
      width: 100%;
      border-collapse: collapse;
    }

    .calendar-table th,
    .calendar-table td {
      width: 14.28%;
      height: 40px;
      text-align: center;
      border: 1px solid #ddd;
      cursor: pointer;
    }

    .calendar-table td:hover {
      background: #e8f8e0;
    }

    .calendar-table .selected {
      background-color: #2ecc71;
      color: #fff;
    }

    .schedule {
      flex: 1;
      background: #fff;
      padding: 10px;
      border: 1px solid #ccc;
    }

    .schedule h3 {
      margin-bottom: 10px;
    }

    .button-group {
      margin-bottom: 10px;
    }

    .schedule-table {
      width: 100%;
      border-collapse: collapse;
    }

    .schedule-table th,
    .schedule-table td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
      position: relative;
      cursor: pointer;
    }

    /* 숨기지만 포커스 가능하게 설정 */
    .schedule-table input[type="text"],
    .schedule-table input[type="checkbox"] {
      position: absolute;
      opacity: 0;
      pointer-events: none;
    }

    /* 시간 열 고정 */
    .schedule-table th:first-child,
    .schedule-table td:first-child {
      width: 110px;
      min-width: 110px;
      max-width: 110px;
      background: #f0f0f0;
      cursor: default;
    }

    /* 선택된 셀 배경 */
    .schedule-table td.selected-cell {
      background-color: #87CEFA;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 달력 -->
    <div class="calendar">
      <div class="calendar-header">
        <button onclick="prevMonth()">&lt;</button>
        <span id="monthYear">2025년 5월</span>
        <button onclick="nextMonth()">&gt;</button>
      </div>
      <table class="calendar-table" id="calendarTable"></table>
    </div>

    <!-- 스케줄 -->
    <div class="schedule">
      <h3 id="selectedDate">2025-05-23 예약 스케줄</h3>
      <div class="button-group">
        <button onclick="saveSchedule()">저장</button>
        <button onclick="editSchedule()">수정</button>
      </div>
      <table class="schedule-table">
        <thead>
          <tr>
            <th>시간</th>
            <th>김계란</th>
            <th>손흥민</th>
            <th>이강인</th>
            <th>기성용</th>
            <th>박지성</th>
          </tr>
        </thead>
        <tbody id="scheduleBody">
          <!-- 자바스크립트로 동적 생성 -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    const trainers = ["김계란", "손흥민", "이강인", "기성용", "박지성"];
    const startHour = 12;
    const endHour = 20;
    let selectedYear = 2025;
    let selectedMonth = 4; // 5월
    let selectedDate = 23;

    window.onload = function () {
      createCalendar(selectedYear, selectedMonth);
      renderScheduleTable();
    };

    function createCalendar(year, month) {
      const table = document.getElementById("calendarTable");
      table.innerHTML = "";

      document.getElementById("monthYear").innerText = `${year}년 ${month + 1}월`;

      const days = ["일", "월", "화", "수", "목", "금", "토"];
      let tr = document.createElement("tr");
      days.forEach(day => {
        const th = document.createElement("th");
        th.innerText = day;
        tr.appendChild(th);
      });
      table.appendChild(tr);

      const date = new Date(year, month, 1);
      tr = document.createElement("tr");

      for (let i = 0; i < date.getDay(); i++) {
        tr.appendChild(document.createElement("td"));
      }

      while (date.getMonth() === month) {
        const td = document.createElement("td");
        const d = date.getDate();
        td.innerText = d;

        td.onclick = () => {
          document.querySelectorAll(".calendar-table td").forEach(td => td.classList.remove("selected"));
          td.classList.add("selected");
          selectedDate = d;
          document.getElementById("selectedDate").innerText =
            `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')} 예약 스케줄`;
        };

        if (d === selectedDate) td.classList.add("selected");

        tr.appendChild(td);

        if (date.getDay() === 6) {
          table.appendChild(tr);
          tr = document.createElement("tr");
        }

        date.setDate(d + 1);
      }

      table.appendChild(tr);
    }

    function renderScheduleTable() {
      const tbody = document.getElementById("scheduleBody");
      tbody.innerHTML = "";

      for (let h = startHour; h <= endHour; h++) {
        const tr = document.createElement("tr");
        const timeTd = document.createElement("td");
        timeTd.innerText = `${h}:00`;
        tr.appendChild(timeTd);

        for (let t = 0; t < trainers.length; t++) {
          const td = document.createElement("td");

          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";

          const input = document.createElement("input");
          input.type = "text";
          input.placeholder = "메모";

          // ✅ 셀 클릭 → 체크박스 토글 + 포커스
          td.addEventListener('click', function () {
            checkbox.checked = !checkbox.checked;
            if (checkbox.checked) {
              td.classList.add("selected-cell");
              input.focus(); // 바로 입력 가능
            } else {
              td.classList.remove("selected-cell");
              input.blur();
            }
          });

          td.appendChild(checkbox);
          td.appendChild(input);
          tr.appendChild(td);
        }

        tbody.appendChild(tr);
      }
    }

    function prevMonth() {
      if (selectedMonth === 0) {
        selectedMonth = 11;
        selectedYear--;
      } else {
        selectedMonth--;
      }
      createCalendar(selectedYear, selectedMonth);
    }

    function nextMonth() {
      if (selectedMonth === 11) {
        selectedMonth = 0;
        selectedYear++;
      } else {
        selectedMonth++;
      }
      createCalendar(selectedYear, selectedMonth);
    }

    function saveSchedule() {
      alert("저장 기능은 서버와 연동 시 구현됩니다.");
    }

    function editSchedule() {
      alert("수정 기능은 아직 구현되지 않았습니다.");
    }
  </script>
</body>
</html>
